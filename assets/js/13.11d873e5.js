(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{268:function(t,s,e){t.exports=e.p+"assets/img/redistype.e306687f.png"},310:function(t,s,e){"use strict";e.r(s);var a=e(2),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"本页目录"}},[t._v("本页目录")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#本页目录"}},[t._v("本页目录")])]),a("li",[a("a",{attrs:{href:"#核心数据类型"}},[t._v("核心数据类型")]),a("ul",[a("li",[a("a",{attrs:{href:"#string"}},[t._v("String")])]),a("li",[a("a",{attrs:{href:"#hash"}},[t._v("Hash")])]),a("li",[a("a",{attrs:{href:"#list"}},[t._v("List")])]),a("li",[a("a",{attrs:{href:"#set"}},[t._v("Set")])]),a("li",[a("a",{attrs:{href:"#zset"}},[t._v("ZSet")])])])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"核心数据类型"}},[t._v("核心数据类型")]),t._v(" "),a("p",[a("img",{attrs:{src:e(268),alt:"redistype.png"}})]),t._v(" "),a("h3",{attrs:{id:"string"}},[t._v("String")]),t._v(" "),a("ul",[a("li",[t._v("常用操作")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("操作")]),t._v(" "),a("th",[t._v("作用")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("SET key value")]),t._v(" "),a("td",[t._v("存入字符串键值对")])]),t._v(" "),a("tr",[a("td",[t._v("MSET key value [key value ...]")]),t._v(" "),a("td",[t._v("批量存入字符串键值对")])]),t._v(" "),a("tr",[a("td",[t._v("SETNX key value")]),t._v(" "),a("td",[t._v("存入一个不存在的字符串键值对")])]),t._v(" "),a("tr",[a("td",[t._v("GET key")]),t._v(" "),a("td",[t._v("读取字符串键值对")])]),t._v(" "),a("tr",[a("td",[t._v("MGET key [key ...]")]),t._v(" "),a("td",[t._v("批量读取字符串键值对")])]),t._v(" "),a("tr",[a("td",[t._v("DEL key [key ...]")]),t._v(" "),a("td",[t._v("删除键值对")])]),t._v(" "),a("tr",[a("td",[t._v("EXPIRE key seconds")]),t._v(" "),a("td",[t._v("设置 key 过期时间 (秒)")])])])]),t._v(" "),a("ul",[a("li",[t._v("原子加减")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("操作")]),t._v(" "),a("th",[t._v("作用")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("INCR key")]),t._v(" "),a("td",[t._v("将 key 中存储的数字加一")])]),t._v(" "),a("tr",[a("td",[t._v("DECR key")]),t._v(" "),a("td",[t._v("将 key 中存储的数字减一")])]),t._v(" "),a("tr",[a("td",[t._v("INCRBY key increment")]),t._v(" "),a("td",[t._v("将 key 中存储的数字加 increment")])]),t._v(" "),a("tr",[a("td",[t._v("DNCRBY key decrement")]),t._v(" "),a("td",[t._v("将 key 中存储的数字减 decrement")])])])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("应用场景")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("单值缓存")]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("SET key value\nGET key\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("对象缓存")]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("SET key:1 value "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# json 格式")]),t._v("\nMSET key:1:n1 value1 key:2:n1 value2\nMGET key:1:n1 key:2:n1\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("分布式锁")]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("SETNX product:10001 "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 返回 1 获取锁成功，0 失败")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 执行业务 ...")]),t._v("\nDEL product:10001 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 释放锁")]),t._v("\nSET product:10001 "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" ex "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" nx "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 防止程序意外终止导致死锁")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("计数器")]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("INCR article:readcount:id1\nGET article:readcount:id1\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("分布式系统全局序列号")]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("INCRBY orderId "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("Web 集群 session 共享")])])])])]),t._v(" "),a("h3",{attrs:{id:"hash"}},[t._v("Hash")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("优点")]),t._v(" "),a("ol",[a("li",[t._v("同类数据归类整合，方便管理")]),t._v(" "),a("li",[t._v("相比 string 消耗内存与 cpu 更少")]),t._v(" "),a("li",[t._v("相比 string 更节省空间")])])]),t._v(" "),a("li",[a("p",[t._v("缺点")]),t._v(" "),a("ol",[a("li",[t._v("过期功能只能用在 key 上")]),t._v(" "),a("li",[t._v("集群架构下不适合大规模使用(数据会集中到一个 master)")])])]),t._v(" "),a("li",[a("p",[t._v("常用操作")])])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("操作")]),t._v(" "),a("th",[t._v("作用")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("HSET key field value")]),t._v(" "),a("td",[t._v("存入一个哈希表 key 的键值")])]),t._v(" "),a("tr",[a("td",[t._v("HSETNX key field value")]),t._v(" "),a("td",[t._v("存入一个不存在的哈希表 key 的键值")])]),t._v(" "),a("tr",[a("td",[t._v("HMSET key field value [field value ...]")]),t._v(" "),a("td",[t._v("在一个哈希表 key 中存入多个键值")])]),t._v(" "),a("tr",[a("td",[t._v("HGET key field")]),t._v(" "),a("td",[t._v("获取哈希表 key 对应的 field 键值")])]),t._v(" "),a("tr",[a("td",[t._v("HMGET key field [field ...]")]),t._v(" "),a("td",[t._v("批量获取哈希表 key 对应的 field 键值")])]),t._v(" "),a("tr",[a("td",[t._v("DEL key field [field ...]")]),t._v(" "),a("td",[t._v("删除哈希表 key 中的 field 键值")])]),t._v(" "),a("tr",[a("td",[t._v("HLEN key")]),t._v(" "),a("td",[t._v("获取哈希表 key 中 field 的数量")])]),t._v(" "),a("tr",[a("td",[t._v("HGETALL key")]),t._v(" "),a("td",[t._v("获取哈希表 key 中多有键值")])]),t._v(" "),a("tr",[a("td",[t._v("HINCRBY key field increment")]),t._v(" "),a("td",[t._v("哈希表 key 中的 field 键值增加 increment")])])])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("应用场景")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("对象缓存")]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("HMSET user "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(":name username "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(":age "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("\nHMGET user "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(":name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(":age\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("ul",[a("li",[t._v("例: 电商购物车"),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 用户id为key")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 商品id为field")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 商品数量为value")]),t._v("\nHSET cart:1001 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 添加商品")]),t._v("\nHINCRBY cart:1001 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 增加商品")]),t._v("\nHLEN cart:1001 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 商品数量")]),t._v("\nHDEL cart:1001 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除商品")]),t._v("\nHGETALL cart:1001 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取购物车所有商品")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])])])])]),t._v(" "),a("li",[a("p",[t._v("分布式锁")]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("SETNX product:10001 "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 返回 1 获取锁成功，0 失败")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 执行业务 ...")]),t._v("\nDEL product:10001 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 释放锁")]),t._v("\nSET product:10001 "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" ex "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" nx "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 防止程序意外终止导致死锁")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])])])])])]),t._v(" "),a("h3",{attrs:{id:"list"}},[t._v("List")]),t._v(" "),a("ul",[a("li",[t._v("常用操作")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("操作")]),t._v(" "),a("th",[t._v("作用")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("LPUSH key value [value ...]")]),t._v(" "),a("td",[t._v("将一个或多个 value 插入到 key 列表的表头")])]),t._v(" "),a("tr",[a("td",[t._v("RPUSH key value [value ...]")]),t._v(" "),a("td",[t._v("将一个或多个 value 插入到 key 列表的表尾")])]),t._v(" "),a("tr",[a("td",[t._v("LPOP key")]),t._v(" "),a("td",[t._v("移除并返回 key 列表的头元素")])]),t._v(" "),a("tr",[a("td",[t._v("RPOP key")]),t._v(" "),a("td",[t._v("移除并返回 key 列表的尾元素")])]),t._v(" "),a("tr",[a("td",[t._v("LRANGE key start stop")]),t._v(" "),a("td",[t._v("返回列表 key 中指定区间内的元素")])]),t._v(" "),a("tr",[a("td",[t._v("BLPOP key [key ...] timeout")]),t._v(" "),a("td",[t._v("从 key 列表表头弹出一个元素，若列表没有元素，阻塞等待 timeout 秒，timeout 为 0 则一直等待")])]),t._v(" "),a("tr",[a("td",[t._v("BLPOP key [key ...] timeout")]),t._v(" "),a("td",[t._v("从 key 列表表尾弹出一个元素，若列表没有元素，阻塞等待 timeout 秒，timeout 为 0 则一直等待")])])])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("应用场景")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("数据结构")]),t._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("Stack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("栈"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" LPUSH + LPOP -"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" FILO\nQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("队列"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" LPUSH + RPOP -"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" FIFO\nBlocking MQ"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("阻塞队列"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" LPUSH + BRPOP\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("信息流")]),t._v(" "),a("ul",[a("li",[t._v("例: 微博消息、微信公众号消息、美团、滴滴"),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# A 发微博 ID 为 10000")]),t._v("\nLPUSH msg:userId "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# B 发微博 ID 为 10001")]),t._v("\nLPUSH msg:userId "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10001")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看最新微博")]),t._v("\nLRANGE msg:userId "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])])])])])])])]),t._v(" "),a("h3",{attrs:{id:"set"}},[t._v("Set")]),t._v(" "),a("h3",{attrs:{id:"zset"}},[t._v("ZSet")]),t._v(" "),a("Valine")],1)}),[],!1,null,null,null);s.default=n.exports}}]);